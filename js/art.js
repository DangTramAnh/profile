const folders = [
    {
      name: { vi: 'Trước khi học MindX', en: 'Before study at MINDX' },
      images: [
        { src: 'https://drive.google.com/file/d/1--IocLXF5Jak3WCSTlA_mrmauH0NoI0y/view?usp=sharing', short: 'Sketch', desc: 'This is a sketch project',type:'drive' },
        { src: 'https://drive.google.com/file/d/1-0rTMICT_i6KfRjBlvcsYLDc2akYhjK6/view?usp=sharing', short: 'Logo', desc: 'This is a logo design', type:'drive' },
        { src: 'https://drive.google.com/file/d/1-DjyxP13zn3ZOzG_xsSyLS3eqz6S2rXb/view?usp=sharing', short: 'UX Flow', desc: 'User experience workflow',type:'drive' },
        { src: 'https://drive.google.com/file/d/1-PMkz9SuW5SHuqnqcCWo3V0JFA5BW9qy/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design', type:'drive'},
        { src: 'https://drive.google.com/file/d/1-ElKQYT3rNneXZuMIe7yS5RXrRN_ZJBH/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design' ,type:'drive'},
        { src: 'https://drive.google.com/file/d/1-OmetBd3K97vGVKtq2QJR0s715c_y-cQ/view?usp=sharing', short: 'Sketch', desc: 'This is a sketch project',type:'drive' },
        { src: 'https://drive.google.com/file/d/1-JyLi4D-wVZ8bXR9S728-NKH6wUnbW6J/view?usp=sharing', short: 'Logo', desc: 'This is a logo design',type:'drive' },
        { src: 'https://drive.google.com/file/d/1-QDyZH8Mm9zBX_-W6Zss_aPXmoG5L43d/view?usp=sharing', short: 'UX Flow', desc: 'User experience workflow',type:'drive' },
        { src: 'https://drive.google.com/file/d/1-RY13bhUpudGhvP7Eu4GjjpT6BsG9C5d/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
        { src: 'https://drive.google.com/file/d/1-UC4NOBjKh_EaVBqArxfAxAr7sKhQKWA/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
        { src: 'https://drive.google.com/file/d/1-XMOBloZy35-ZFnwBvMdlSJwGj-JW__5/view?usp=sharing', short: 'Sketch', desc: 'This is a sketch project',type:'drive' },
        { src: 'https://drive.google.com/file/d/1-bGTqA_C2lvBFJ92mQxCq78xYfAs1XG1/view?usp=sharing', short: 'Logo', desc: 'This is a logo design',type:'drive' },
        { src: 'https://drive.google.com/file/d/1-cACvRtbMVhCt3RLj_rOjERGUBFzDk4U/view?usp=sharing', short: 'UX Flow', desc: 'User experience workflow',type:'drive' },
        { src: 'https://drive.google.com/file/d/1-dqfwrS0vOQUVwTVHldTXmjA9HuUnkRj/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
        { src: 'https://drive.google.com/file/d/1-FvWn9N5RFdEndMW1PXu-r6SpfPeHnRa/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
      ]
    },
    {
      name: { vi: 'Trong khi học MindX', en: 'While study in MindX' },
      images: [
        { src: 'https://drive.google.com/file/d/101lNYzBCC0Pee9-7ncjR38djPjQViKtr/view?usp=sharing', short: 'Sketch', desc: 'This is a sketch project',type:'drive' },
        { src: 'https://drive.google.com/file/d/10GQpN3KcGDgvLaOLCI-QahDiZw_cOkXc/view?usp=sharing', short: 'Logo', desc: 'This is a logo design',type:'drive' },
        { src: 'https://drive.google.com/file/d/10HTx97Dz1ROG-xvtXi_mrlEdiA-Diuki/view?usp=sharing', short: 'UX Flow', desc: 'User experience workflow',type:'drive' },
        { src: 'https://drive.google.com/file/d/10YSv0BY2jghCH3RtVcv1t69TdHJdVg0i/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
        { src: 'https://drive.google.com/file/d/10cpN26STQtxap6Oq-FzmsfKzydMqG21F/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
        { src: 'https://drive.google.com/file/d/10kCkqux6B20yQdBXxFwiLJl7hOTw7w0D/view?usp=sharing', short: 'Sketch', desc: 'This is a sketch project',type:'drive' },
        { src: 'https://drive.google.com/file/d/10lKiEXZMgco3rNcvqAF8acEehNkjqcpt/view?usp=sharing', short: 'Logo', desc: 'This is a logo design',type:'drive' },
        { src: 'https://drive.google.com/file/d/10qQ1ewh-mY_rgLhhQXFt7bEznKmyLz1E/view?usp=sharing', short: 'UX Flow', desc: 'User experience workflow',type:'drive' },
        { src: 'https://drive.google.com/file/d/10r2y9JbFLonFvsq_eRwwiFexMNEzim4W/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
        { src: 'https://drive.google.com/file/d/10ssC0ObH_mCgHTTJKAucF3dnltufwULw/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
        { src: 'https://drive.google.com/file/d/11-Hb9CuZoojXuCqZf2DU3RezXP0y28hF/view?usp=sharing', short: 'Sketch', desc: 'This is a sketch project',type:'drive' },
        { src: 'https://drive.google.com/file/d/113wjTTY-8J0Z2mhT-LL4bhu3cSdd77mp/view?usp=sharing', short: 'Logo', desc: 'This is a logo design',type:'drive' },
        { src: 'https://drive.google.com/file/d/115CMlcoAbqGAR7PDWrBTl7z04nAzJJCC/view?usp=sharing', short: 'UX Flow', desc: 'User experience workflow',type:'drive' },
      ]
    },
    {
        name: { vi: 'Sau khi học MindX', en: 'After study in MindX' },
        images: [
          { src: 'https://drive.google.com/file/d/11Frr7cO_kudWcKp-edY6SMreFCn8piIl/view?usp=sharing', short: 'Banner', desc: 'Banner design' ,type:'drive'},
          { src: 'https://drive.google.com/file/d/11G-gn5aNRKaZgVXSL7cGglNQq0FKMdSE/view?usp=sharing', short: 'Banner', desc: 'Banner design',type:'drive' },
        ]
      },
      {
        name: { vi: 'Dự án trong lớp', en: 'Project in class' },
        images: [
            { 
                src: 'https://drive.google.com/file/d/1QHZeZ8usNX-QJCySV5sVkqTqLk2E3ZW-/preview', 
                short: 'Sketch', 
                desc: 'This is a sketch project', 
                type:'drive' 
              },
            { src: 'https://drive.google.com/file/d/1-TdM10Ejyx4_6DPEie4K9Hd4Y_zZZTdg/view?usp=sharing', short: 'Logo', desc: 'This is a logo design',type:'drive' },
            { src: 'https://drive.google.com/file/d/1-Zm-W2MTv1NXMc5rssrok8UiodeiF2TQ/view?usp=sharing', short: 'UX Flow', desc: 'User experience workflow',type:'drive' },
            { src: 'https://drive.google.com/file/d/1-Y1_4ZOEgjk0rILjpfxSvn7ZBvqq-JoH/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
            { src: 'https://drive.google.com/file/d/1-WM6mSAQWHnG1cywpXyoKrSev6Hc5UX4/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
            { src: 'https://drive.google.com/file/d/1-zVTjhvrY6Pznw6jQ9ldXpeViYCGNVHG/view?usp=sharing', short: 'Sketch', desc: 'This is a sketch project',type:'drive' },
            { src: 'https://drive.google.com/file/d/1-dgUaGxsGje0JUKmzST0AtsAhVxI2U7b/view?usp=sharing', short: 'Logo', desc: 'This is a logo design',type:'drive' },
            { src: 'https://drive.google.com/file/d/100WnNAIsMxbWK7CIJwxmZHzzO-m_geGe/view?usp=sharing', short: 'UX Flow', desc: 'User experience workflow',type:'drive' },
            { src: 'https://drive.google.com/file/d/1-vr980ukVg5zt6ogqByv6_76U5Czfht5/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
            { src: 'https://drive.google.com/file/d/1-tgBjeeRUJpqZaOWH4C4m-8hjcxgMCGl/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
            { src: 'https://drive.google.com/file/d/1-ripyI6q3CWIkfzhcxjj6_PTivTNf0Eu/view?usp=sharing', short: 'Sketch', desc: 'This is a sketch project',type:'drive' },
            { src: 'https://drive.google.com/file/d/1-q9N-FeNH_oqyGgE7ZgBEbFl2UQ7Nacw/view?usp=sharing', short: 'Logo', desc: 'This is a logo design',type:'drive' },
            { src: 'https://drive.google.com/file/d/1-cTchPAUBGg4IPrOxDOIzLd8IbuwBw5T/view?usp=sharing', short: 'UX Flow', desc: 'User experience workflow',type:'drive' },
            { src: 'https://drive.google.com/file/d/1-awLXAlxnAQNJW-W9d3q5AT8NjHPUJps/view?usp=sharing', short: 'Sketch', desc: 'This is a sketch project',type:'drive' },
            { src: 'https://drive.google.com/file/d/119Gi5Zc2VK5mr-hvSxeg4B9QxIf7S-Z8/view?usp=sharing', short: 'Logo', desc: 'This is a logo design',type:'drive' },
            { src: 'https://drive.google.com/file/d/11Vj_Y8l7EeoQuApBfV9aQaO1J3M-skWP/view?usp=sharing', short: 'UX Flow', desc: 'User experience workflow',type:'drive' },
            { src: 'https://drive.google.com/file/d/112c3QLJdevGDU9SdHn9prK4ShyzKIA9G/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
            { src: 'https://drive.google.com/file/d/111jSxiRNqPwTOxP-HvN1BF8GqYQHlcPK/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
            { src: 'https://drive.google.com/file/d/11-uXuhy_pwg8pQq_WyT001WkGxRuunMt/view?usp=sharing', short: 'Sketch', desc: 'This is a sketch project',type:'drive' },
            { src: 'https://drive.google.com/file/d/10xDjGT1xRb7VNCAaMPK-Zk8RQZ8NoLX_/view?usp=sharing', short: 'Logo', desc: 'This is a logo design',type:'drive' },
            { src: 'https://drive.google.com/file/d/10vp5kSvMDM6trYggCCSBJR5etzb51Bao/view?usp=sharing', short: 'UX Flow', desc: 'User experience workflow',type:'drive' },
            { src: 'https://drive.google.com/file/d/10n8-i9QLwXOG3LfsMrkjnTZxexgFcxWS/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
            { src: 'https://drive.google.com/file/d/10j0AFz62VtvOvoXMf6ek_CGoTH3_KWcf/view?usp=sharing', short: 'Wireframe', desc: 'Wireframe design',type:'drive' },
            { src: 'https://drive.google.com/file/d/10Vutf7LVo8Pvc0s9nhqFA0oEDJuuEhkF/view?usp=sharing', short: 'Sketch', desc: 'This is a sketch project',type:'drive' },            
        ]
      },
  ];

  let currentOpen = null;
  let currentFolder = null;

  
  function createGallery(folderData) {
    const images = folderData.images || [];
    const wrapper = document.createElement('div');
    wrapper.className = 'gallery-wrapper';
  
    const gallery = document.createElement('div');
    gallery.className = 'gallery';
  
    const leftArrow = document.createElement('span');
    leftArrow.className = 'arrow';
    leftArrow.innerHTML = '&#9664;';
  
    const rightArrow = document.createElement('span');
    rightArrow.className = 'arrow';
    rightArrow.innerHTML = '&#9654;';
  
    const viewer = document.createElement('div');
    viewer.className = 'image-viewer';
  
    const desc = document.createElement('div');
    desc.className = 'description';
  
    leftArrow.onclick = () => scrollImages(-1, viewer);
    rightArrow.onclick = () => scrollImages(1, viewer);
  
    images.forEach((imgObj) => {
      const box = document.createElement('div');
      box.className = 'image-box';
  
      let media;
  
      if (imgObj.type === 'video') {
        media = document.createElement('video');
        media.src = imgObj.src;
        media.controls = true;
        media.onclick = () => desc.textContent = imgObj.desc;
        box.appendChild(media);
      } 
      else if (imgObj.type === 'drive') {
        const previewLink = imgObj.src.replace('/view?usp=sharing', '/preview');
        const iframeWrapper = document.createElement('div');
        iframeWrapper.className = 'drive-portrait-wrapper';
  
        media = document.createElement('iframe');
        media.src = previewLink;
        media.allow = 'autoplay';
        media.frameBorder = 0;
        media.allowFullscreen = true;
  
        iframeWrapper.appendChild(media);
        iframeWrapper.onclick = () => desc.textContent = imgObj.desc;
  
        box.appendChild(iframeWrapper);
      } 
      else {
        media = document.createElement('img');
        media.src = imgObj.src;
        media.alt = imgObj.short;
        media.onclick = () => desc.textContent = imgObj.desc;
        box.appendChild(media);
      }
  
      const overlay = document.createElement('div');
      overlay.className = 'overlay';
      overlay.textContent = imgObj.short;
  
      box.appendChild(overlay);
      viewer.appendChild(box);
    });
  
    gallery.appendChild(leftArrow);
    gallery.appendChild(viewer);
    gallery.appendChild(rightArrow);
    wrapper.appendChild(gallery);
    wrapper.appendChild(desc);
  
    return wrapper;
  }

  function scrollImages(direction, viewer) {
    const scrollAmount = viewer.querySelector('.image-box')?.offsetWidth + 10 || 190;
    viewer.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
  }

  function loadFolders() {
    const folderList = document.getElementById('folder-list');
    folderList.innerHTML = '';
    currentOpen = null;
    currentFolder = null;

    folders.forEach(folderData => {
      const folder = document.createElement('div');
      folder.className = 'folder';
      folder.innerHTML = `
        <span class="lang vi">${folderData.name.vi}</span>
        <span class="lang en" style="display:none">${folderData.name.en}</span>
      `;

      folder.onclick = () => {
        if (currentFolder === folder) {
          currentOpen.classList.remove('open');
          const toRemove = currentOpen;
          currentOpen = null;
          currentFolder = null;
          setTimeout(() => folderList.removeChild(toRemove), 500);
          return;
        }

        if (currentOpen) {
          currentOpen.classList.remove('open');
          const toRemove = currentOpen;
          currentOpen = null;
          currentFolder = null;
          setTimeout(() => folderList.removeChild(toRemove), 500);
        }

        const galleryWrapper = createGallery(folderData);
        folderList.insertBefore(galleryWrapper, folder.nextSibling);
        setTimeout(() => galleryWrapper.classList.add('open'), 10);
        currentOpen = galleryWrapper;
        currentFolder = folder;
      };

      folderList.appendChild(folder);
    });
  }

  function toggleLanguage() {
    const htmlLang = document.documentElement.lang;
    const newLang = htmlLang === 'vi' ? 'en' : 'vi';
    document.documentElement.lang = newLang;

    document.querySelectorAll('.lang.vi').forEach(el => el.style.display = newLang === 'vi' ? 'inline' : 'none');
    document.querySelectorAll('.lang.en').forEach(el => el.style.display = newLang === 'en' ? 'inline' : 'none');

    const flag = document.getElementById('flagIcon');
    if (flag) {
      flag.src = newLang === 'vi'
        ? 'https://flagcdn.com/w40/vn.png'
        : 'https://flagcdn.com/w40/us.png';
    }
  }

  document.getElementById('langToggle').onclick = toggleLanguage;
  loadFolders();